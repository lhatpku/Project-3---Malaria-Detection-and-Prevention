<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <!--Import Google Icon Font-->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <!-- Compiled and minified CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-beta/css/materialize.min.css">

  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">

  <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/map.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/cnn.css') }}"> 
  <link rel="stylesheet" href="{{ url_for('static', filename='css/regression.css') }}"> 
  <link rel="stylesheet" href="{{ url_for('static', filename='css/classification.css') }}"> 

  <link rel="stylesheet" href="{{ url_for('static', filename='css/leaflet.css') }}"> 
  <link rel="stylesheet" href="{{ url_for('static', filename='plugin/L.Control.Zoomslider.css') }}"> 
  <link rel="stylesheet" href="{{ url_for('static', filename='plugin/L.Control.MousePosition.css') }}"> 
  <link rel="stylesheet" href="{{ url_for('static', filename='plugin/L.Control.Pan.css') }}"> 
  <link rel="stylesheet" href="{{ url_for('static', filename='plugin/L.Control.Sidebar.css') }}"> 
  <link rel="stylesheet" href="{{ url_for('static', filename='plugin/easy-button.css') }}">

  <title>Malaria Detection and Prevention</title>
  <link href="https://fonts.googleapis.com/css?family=Lato|Playfair+Display" rel="stylesheet">

</head>
  
<body>

    <div class = "section container">
        <h2>Malaria</h2>
        <p>Malaria is a disease that is transmitted from person to person by infected mosquitoes.<br>
            Malaria can be fatal. The World Health Organization (WHO) estimates that 438,000 people died because of malaria in 2015;
            the Institute of Health Metrics and Evaluation (IHME), Global Burden of Disease (GBD) puts this estimate at 620,000 in 2017.
        </p>
    </div>

    <div style="text-align:center">
        <span class="dot" onclick="currentSlide(1)"></span> 
        <span class="dot" onclick="currentSlide(2)"></span> 
        <span class="dot" onclick="currentSlide(3)"></span> 
    </div>
        
    <header id = "background">

        <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
        <a class="next" onclick="plusSlides(1)">&#10095;</a>
        
    </header>

    <!-- Malaria world trend -->
    <div class = "section container">

        <h2>Empirical View</h2>

        <section>

            <h3>Malaria death by Countries</h3>
            <p>Malaria occurs mostly in poor, tropical and subtropical areas of the world. Africa is the most affected due to a combination of factors:</p>
            <ol>
                <li>A very efficient mosquito (Anopheles gambiae  complex) is responsible for high transmission.</li>
                <li>The predominant parasite species is Plasmodium falciparum , which is the species that is most likely to cause severe malaria and death.</li>
                <li>Local weather conditions often allow transmission to occur year round.</li>
                <li>Scarce resources and socio-economic instability have hindered efficient malaria control activities.</li>
                <li>In other areas of the world, malaria is a less prominent cause of deaths, but can cause substantial disease and incapacitation, especially in some countries in South America and South Asia.</li>
            </ol>

            <form name="Trends">
                <p class = "radio-btn" style="margin:0.5rem 1rem 0.5rem 0">
                    <label>
                    <input name="Trend" type="radio" checked value="Sunburst">
                    <span><i class="material-icons">pie_chart</i></span>
                    </label>
                </p>
                <p class="radio-btn" style="margin:0.5rem 1rem">
                    <label>
                    <input name="Trend" type="radio" value="Map">
                    <span><i class="material-icons">map</i></span>
                    </label>
                </p>
            </form>

            <div id="sun-burst"></div>
            <svg id = "map" width="960" height="600"></svg>

            <form action="#">
                <p class="range-field">
                    <input type="range" id="range" min="2000" max="2017" step="1" value="2017"/>
                </p>
            </form>

        </section>

        <hr>

        <section>

            <h3>Malaria death by Age Groups</h3>
            <p>At a global level, the most vulnerable age group to malaria deaths are children under five years old — in 2017 they accounted for 57 percent of total deaths. 
                The number of deaths from malaria tends to decrease with age; with those over 70 years old accounting for around five percent. 
                When age categories are combined, children under 14 years old account for more than two-thirds of mortality. 
            </p>

            <div class="row">
                <div id="area" class="col m9 push-m1"></div>
            </div>

        </section>
    
    </div>

    <div class = "section container">
        <h2>Prediction and Prevention</h2>
        <section>
            <h3>Malaria and Mosquitoes Population</h3>
            <p>Malaria is caused by a one-celled parasite called a Plasmodium. 
                Female Anopheles mosquitoes pick up the parasite from infected people when they bite to obtain blood needed to nurture their eggs. 
                Inside the mosquito the parasites reproduce and develop. When the mosquito bites again, 
                the parasites contained in the salivary gland are injected and pass into the blood of the person being bitten.
            </p>
            <h4>Mosquitoes Population Over-time (in Africa)</h4>
            <div id="leaflet-side-bar">
                <label>Year Category</label>
                <select class="browser-default" id="period-select">
                    <option value="default" disabled selected>Choose your option</option>
                    {% for period in periods %}
                    <option value="{{ period }}">{{ period }}</option>
                    {% endfor %}
                </select>
            </div>

            <div id="mosquitoes-vector"></div>
          
        </section>
        <hr>
        <section>
            <h3>Malaria and Other Factors</h3>
            <h4>Regression Model</h4>
            <div class="row">
                <div class="col s12 m3">
                    <form class="card z-depth-2">
                        <div class="card-content">
                            <div class="input-field">
                                <select class="icons" id="feature-select">
                                    <option value="GDP"selected>GDP Per Capital</option>
                                    <option value="Child Mortality" >Child Mortality </option>
                                    <option value="Percipitation">Percipitation</option>
                                    <option value="Temperature">Temperature</option>
                                </select>
                            </div>
                            <div class="input-field">
                                <select class="icons" id="model-select">
                                    <option value="linear" selected>Linear</option>
                                    <option value="quad" >Quadratic</option>
                                </select>
                            </div>    
                        </div>
                    </form>
                </div>
                <div class="s12 col m8 push-m1" id="regression-plot"></div>
            </div>
        </section>

        <section>
            <h4>Classification Model</h4>
            <div class="row">
                <div class="col m8 s12 push-m2">
                    <div class="card">
                        <div class="card-content">
                            <span class="card-title">Classification by Incidents Count</span>
                            <div id="classification-chart"></div>
                        </div>
                        <div class="card-action">
                            <form>

                                <div class="row">
                                    <div class="input-field col m6 card-panel">
                                        <input id="threshold" type="text" class="validate">
                                        <label for="threshold">Classification Threshold</label>
                                    </div>

                                    <div class="input-field col m5 push-m1 card-panel">   
                                        <label id="beta_val"></label>
                                        <input type="range" name="beta" min="0" max="1.0" step="0.01" oninput=displayBeta(this.value) onchange=runGradientDescent(this.value)>           
                                    </div>

                                </div>
                                
                            </form>

                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <div class = "section container">
        <h2>Malaria Detection</h2>

        <h3>Blood Cell Image to Identify Malaria</h3>
        <p>Malaria parasites go through a series of steps on their way to causing disease in humans. 
                When a malaria-carrying mosquito bites a human host, the malaria parasite enters the bloodstream, multiplies in the liver cells, 
                and is then released back into the bloodstream, where it infects and destroys red blood cells. 
                Parasites invade red blood cells in an attempt to evade the immune system and to remodel them for their own use.
        </p>

        <div class="row">

            <div class="col s12 m5">

                <ul class="collapsible">
                    
                    <li>
                        <div class="collapsible-header"><i class="fas fa-book-medical"></i>Cell Image Detection</div>
                        <div class="collapsible-body brown lighten-4"><span>Malaria parasites can be identified by examining under the microscope a drop of the patient’s blood, spread out as a “blood smear” on a microscope slide. 
                            Prior to examination, the specimen is stained to give the parasites a distinctive appearance. 
                            This technique remains the gold standard for laboratory confirmation of malaria. </span></div>
                    </li>
                    <li>
                        <div class="collapsible-header"><i class="fas fa-database"></i>Data</div>
                        <div class="collapsible-body brown lighten-4"><span>
                            The dataset comes from <a href="https://www.kaggle.com/iarunava/cell-images-for-detecting-malaria">Kaggle</a>. 
                            The parasitized (infected) cell images are inside the Parasitized folder and uninfected images are inside the Uninfected folder.
                        </span></div>
                    </li>
                    <li>
                        <div class="collapsible-header"><i class="fas fa-laptop-medical"></i>Our Method</div>
                        <div class="collapsible-body brown lighten-4"><span>
                            We created the Convolution Layer followed by a MaxPooling layer 
                            then normalize the output from the previous layers and apply the Dropout regularization. 
                            Another set of these layers is then appended. 
                        </span></div>
                    </li>
                </ul>

            </div>

            <div class="col s12 m6 push-m1">
                <div class="card">

                    <div class="card-action center">

                        <form id="upload-file" method="post" enctype="multipart/form-data">
                            <label for="imageUpload" class="upload-label">
                                <i class="fas fa-file-upload"></i>
                            </label>
                            <input type="file" name="file" id="imageUpload" accept=".png, .jpg, .jpeg">
                        </form>

                    </div>

                    <div class="card-image center">
                        <div class="image-section" style="display:none;">
                            <div class="img-preview center">
                                <div id="imagePreview">
                                </div>
                            </div>
                            <div>
                                <button type="button" class="btn btn-primary btn-lg " id="btn-predict">Predict!</button>
                            </div>
                        </div>
                    </div>

                    <div class="card-content center">
                        <div class="loader" style="display:none;"></div>

                        <h3 id="result">
                            <span> </span>
                        </h3>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <footer class="page-footer grey darken-3">
        <div class="container">
            <div class="row">
            <div class="col s12 m8 offset-m2">
                <h5>About The Project</h5>
                <p>The project is to give an overview to answer the questions as "what is malaria and how it impacts human society", "how to detect malaria" and "what we can do to better control it"
                    We use Convolutional Neural Network to detect the disease from cell level and use different regression models to find the best way to control and prevent.
                </p>
            </div>
            </div>
        </div>
        <div class="footer-copyright grey darken-4">
            <div class="container center-align">
            &copy; 2019 Project - Malaria Detection and Prevention: Hao Lu | Eric Yang | Tracy Guo
            </div>
        </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script> 
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-beta/js/materialize.min.js"></script>

    <script src="{{ url_for('static', filename='js/leaflet-src.js') }}"></script>
    <script src="{{ url_for('static', filename='plugin/L.Control.Zoomslider.js') }}"></script>
    <script src="{{ url_for('static', filename='plugin/L.Control.MousePosition.js') }}"></script>
    <script src="{{ url_for('static', filename='plugin/L.Control.Pan.js') }}"></script>
    <script src="{{ url_for('static', filename='plugin/L.Control.Sidebar.js') }}"></script>
    <script src="{{ url_for('static', filename='plugin/easy-button.js') }}"></script>

    <script src="https://code.highcharts.com/highcharts.src.js"></script>
    <script src="https://code.highcharts.com/highcharts-3d.js"></script>
    <script src="https://code.highcharts.com/modules/sunburst.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.5.0/d3.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-tip/0.9.1/d3-tip.js"></script>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://unpkg.com/topojson@3.0.2/dist/topojson.min.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>

    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

    <script src="http://feyderm.github.io/math/math.js"></script>

    <script>
        $(document).ready(function(){
            $('select').formSelect();
            $('.collapsible').collapsible();
        });
    </script>
    
    <script src="{{ url_for('static', filename='js/background.js') }}"></script>
    <script src="{{ url_for('static', filename='js/trend_sunburst.js') }}"></script>
    <script src="{{ url_for('static', filename='js/trend_map.js') }}"></script>
    <script src="{{ url_for('static', filename='js/vector_map.js') }}"></script>
    <!-- Only for area chart -->
    <script src="{{ url_for('static', filename='js/trend_area.js') }}"></script>
    <script src="{{ url_for('static', filename='js/cnn.js') }}"></script> 
    <script src="{{ url_for('static', filename='js/radio.js') }}"></script> 
    <script src="{{ url_for('static', filename='js/regression.js') }}"></script> 
    <script src="{{ url_for('static', filename='js/classification.js') }}"></script> 

  </body>